### Проблема
[[../03 Основное/GoF Цепочка обязанностей]] и [[../03 Основное/GoF Декоратор]] имеют очень похожие структуры. Оба паттерна базируются на принципе [[../../../../Java/Core/Рекурсия|рекурсивного]] выполнения операции через серию связанных объектов. 

Как понять рекурсивное выполнение?
### Решение 

#### Цепочка обязанностей (Chain of Responsibility)

В паттерне **Цепочка обязанностей** каждый объект в цепочке имеет ссылку на следующий объект. Когда поступает запрос, первый объект в цепочке обрабатывает его или передает следующему объекту в цепочке, если он не может его обработать. Этот процесс продолжается до тех пор, пока запрос не будет обработан или цепочка не закончится.

Этот процесс напоминает рекурсивный вызов функций, где каждый объект передает управление следующему, пока не достигнется условие завершения.

#### Декоратор (Decorator)

В паттерне **Декоратор** объекты декораторов "оборачивают" другие объекты, добавляя к ним дополнительное поведение. Каждый декоратор имеет ссылку на объект, который он декорирует (что может быть другим декоратором или базовым объектом). Когда вызывается метод, декоратор может выполнить свою часть логики, а затем передать управление объекту, который он декорирует.

### Пример

#### Цепочка обязанностей:

- Объект A получает запрос и проверяет, может ли он его обработать.
- Если не может, он передает запрос объекту B.
- Объект B делает то же самое: проверяет и, если не может обработать, передает объекту C.
- Процесс продолжается до тех пор, пока один из объектов не обработает запрос или цепочка не завершится.

Этот процесс <mark style="background: #ABF7F7A6;">напоминает рекурсивный вызов функций, где каждый объект передает управление следующему</mark>, пока не достигнется условие завершения.
#### Декоратор

- Базовый объект имеет метод `execute()`, который выполняет какое-то действие.
- Декоратор A оборачивает базовый объект и имеет метод `execute()`, который вызывает `execute()` базового объекта, добавляя при этом свое поведение.
- Декоратор B оборачивает декоратор A и тоже имеет метод `execute()`, который вызывает `execute()` декоратора A, добавляя еще одно поведение.
- Когда клиент вызывает `execute()` на декораторе B, сначала выполняется логика декоратора B, затем он вызывает `execute()` на декораторе A, а затем декоратор A вызывает `execute()` на базовом объекте.

Таким образом, выполнение "рекурсивно" <mark style="background: #ABF7F7A6;">проходит через цепочку декораторов до базового объекта</mark> и возвращается обратно, как в рекурсивном вызове функции.
### Резюме

"Рекурсивное выполнение" в контексте паттернов **Цепочка обязанностей** и **Декоратор** означает передачу выполнения от одного объекта к другому по цепочке (или через серию декораторов), где каждый объект может добавить или изменить поведение до того, как передать выполнение следующему объекту. Этот процесс похож на рекурсивный вызов функций, хотя технически это не является рекурсией в традиционном смысле.

