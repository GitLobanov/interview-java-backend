Вообще `lost update` случается, когда перед изменением значения идет его чтение, чтобы на основе старого значения можно было вывести новое.

Для предотвращения этой аномалии есть несколько механизмов:

- Atomic operations. В БД реализованны некоторые атомарные операции, но их функциональности может не хватать.
- Pessimistic locking. Можно использовать блокировки, в рамках которых можно прочитать и поменять значения. Для этого используют конструкцию `SELECT FOR UPDATE`.
- Optimistic locking. Реализацией такой блокировки является MVCC, который используется в уровне изоляции `Repeatable read`.

Это ситуация, когда два или более транзакций одновременно обновляют одни и те же данные, и одно из обновлений теряется, поскольку последнее обновление перезаписывает изменения, сделанные предыдущими транзакциями.

![[../../../../_res/Pasted image 20240829200416.png]]