Service-discovery ложится на плечи приложения

- Нужна библиотека для каждого языка программирования
- Мы ответственны за установку и управление инфраструктурой

Первый способ обнаружения сервисов — на стороне клиента. В этом случае сервисы и их клиенты напрямую взаимодействуют с реестром. Последовательность шагов следующая:

1. Экземпляр сервиса обращается к API реестра, чтобы зарегистри­ровать свое сетевое местоположение. Он также может предоставить URL-адрес для проверки своей работоспособности (Health Check), который будет использоваться для продления срока его регистрации в реестре.
2. Клиент самостоятельно обращается к реестру сервисов, чтобы получить список экземпляров сервисов. Для улучшения производительности клиент может кэшировать экземпляры сервиса.
3. Клиент использует алгоритм балансировки нагрузки, циклический или случайный, чтобы выбрать конкретный экземпляр сервиса и отправить ему запрос.

Ключевое преимущество обнаружения сервисов на стороне клиента — его независимость от используемой платформы развертывания. Например, если часть ваших сервисов развернута на K8s, а остальные работают в устаревшей среде, то обнаружение на уровне приложения будет лучшим вариантом, так как серверное решение на базе Kubernetes не будет совместимо со всеми сервисами.

К недостаткам подхода можно отнести необходимость использования различных клиентских библиотек для каждого языка программирования, а иногда и фреймворка. Кроме этого, на вашу команду ложится дополнительная нагрузка по настройке и обслуживанию реестра сервисов.

![[Pasted image 20241215101715.png]]


- Сервис сам регистрируется в реестре
- Клиент приходит в реестр и запрашивает список экземпляров сервиса. Он может их закэшировать для улучшения производительности.
- Клиент сам выбирает экземпляр из списка и идет к нему с запросом.

![[Pasted image 20241009143343.png]]

- Плюсы:
	- Независимость от используемой платформы развертывания (серверы могут быть
развернуты в разных средах, а балансировка будет происходить на стороне клиента,
поэтому нам без разницы)
- Минусы:
	- Клиент завязывается на дополнительный модуль - Discovery Service
	- Клиенту самому надо балансировать нагрузку