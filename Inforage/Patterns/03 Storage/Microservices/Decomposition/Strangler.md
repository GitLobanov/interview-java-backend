Рассмотренные выше способы разбиения на микросервисы хорошо подходят для новых приложений, создаваемых с нуля. Однако на практике часто возникает необходимость перевести на микросервисную архитектуру уже существующие монолитные приложения. Разложение монолита на микросервисы требует времени и не может быть выполнено за одну итерацию. Поэтому и был разработан паттерн Strangler, названный по аналогии с лианой, которая постепенно душит обвиваемое ею дерево.

Этот шаблон означает миграцию монолитного приложения на микросервисную архитектуру путем постепенного переноса существующих функций в микросервисы. Настраивается маршрутизация запросов между устаревшим монолитом и микросервисами. Когда очередная функциональность переносится из монолита в микросервисы, фасад перехватывает клиентский запрос и направляет его к микросервисам. Новые функции при этом реализуются исключительно в микросервисах, минуя монолит. После переноса всех функций монолитное приложение полностью выводится из эксплуатации.

Паттерн не рекомендуется использовать при небольших размерах монолита. В таком случае лучшим решением будет его единовременный перевод на микросервисную архитектуру, так как добавление фасада увеличивает задержки и затрудняет тестирование.

![[Pasted image 20241215093946.png]]

![[Pasted image 20241009123111.png]]

- Паттерн Strangler позволяет реорганизовать систему без простоя.
- Для обновления системы нужно сделать как минимум 3 последовательных развертывания.
- Паттерн Strangler подходит для рефакторинга не только структуры данных, но и кода.
- Подумайте, как хэндлить сервисы  и data store, которые  будут использоваться как новыми, так и устаревшими сервисами. Убедитесь, что обе системы имеют доступ к этим ресурсам одновременно.
- Структурируйте новые приложения и сервисы таким образом, чтобы их можно было легко таким же образом заменить при будущем применении паттерна уже к ним.
- В какой-то момент, когда миграция будет завершена, strangler fig facade либо будет удален, либо превратится в адаптер для устаревших клиентов.
- Убедитесь, что фасад не отстает от миграции.
- Убедитесь, что фасад не становится единственной точкой отказа или узким местом в производительности.

- **Использовать когда**:
	- Используйте этот шаблон при постепенном переносе back-end приложения на новую архитектуру.
- ***Не** использовать когда*:
	- Когда запросы на back-end систему не могут быть "перехвачены".
	- Для маленьких систем где complexity по полному переносу на новый сервис незначительно

# Resources

- 