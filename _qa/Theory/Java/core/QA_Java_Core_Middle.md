#### Как скомпилировать и запустить класс, используя консоль?

• <Путь_к_JDK>\bin\javac <Путь_к_java-классу>\<Имя_класса>.java  
После этого в папке с java-файлом появится файл <Имя_класса>.class  
Более подробно: <Путь_к_JDK>\bin\javac -d <Директория_build> -sourcepath <Список_директорий_через_;> <Путь_к_java-классу>\<Имя_класса>.java  
• <Путь_к_JDK>\bin\java <Путь_к_java-классу>\<Имя_класса>  
Если путь к JDK прописан в classpath:  
• javac <Путь_к_java-классу>\<Имя_класса>.java  
• java <Путь_к_java-классу>\<Имя_класса>

#### Настройки памяти и gc (-Xms, -Xmx, -Xss, -XX:+Use...)

```bash
-Xms256m  # Начальный размер хипа
-Xmx1024m # Максимальный размер
```

```bash
-XX:+UseG1GC            # Garbage-First (по умолчанию с Java 9)
-XX:+UseParallelGC      # Parallel GC
-XX:+UseConcMarkSweepGC # CMS (устарел)
-XX:+UseZGC             # ZGC (для больших хипов)
```
#### Из чего состоит стэк?

- **Фреймы стека** (Stack Frames) — на каждый вызов метода:
    1. **Локальные переменные**.
    2. **Операндный стек** (для вычислений).
    3. **Ссылка на текущий класс** (для `this`).
    4. **Возвращаемое значение**.
    5. **Ссылка на константы**.

#### Почему Perm Gen был изменен на Metaspace?

- **PermGen**: Фиксированный размер, OutOfMemoryError.
- **Metaspace**: Автомасштабирование в нативной памяти.

#### Сколько занимает хип по умолчанию?

- **Начальный размер heap'а (Xms)**:  
    обычно составляет **1/64 от доступной физической памяти**,  
    но не менее **8 МБ**.
- **Максимальный размер heap'а (Xmx)**:  
    примерно **1/4 от доступной физической памяти**,  
    но есть потолки и по самой JVM/ОС.

Пример:

На машине с **16 ГБ ОЗУ**:
- `-Xms` (начальный heap): ≈ **256 МБ**
- `-Xmx` (максимальный heap): ≈ **4 ГБ**

#### Как получить дамп потока?

Среды исполнения Java на основе HotSpot генерируют только дамп в формате HPROF. В распоряжении разработчика имеется несколько интерактивных методов генерации дампов и один метод генерации дампов на основе событий.

Интерактивные методы:

- Использование Ctrl+Break: если для исполняющегося приложения установлена опция командной строки `-XX:+HeapDumpOnCtrlBreak`, то дамп формата HPROF генерируется вместе с дампом потока при наступлении события `Ctrl+Break` или `SIGQUIT` (обычно генерируется с помощью _kill -3_), которое инициируется посредством консоли. Эта опция может быть недоступна в некоторых версиях. В этом случае можно попытаться использовать следующую опцию: `-Xrunhprof:format=b,file=heapdump.hprof`
- Использование инструмента _jmap_: утилита _jmap_, поставляемая в составе каталога `/bin/` комплекта JDK, позволяет запрашивать дамп HPROF из исполняющегося процесса.
- Использование операционной системы: Для создания файла ядра можно воспользоваться неразрушающей командой _gcore_ или разрушающими командами _kill -6_ или _kill -11_. Затем извлечь дамп кучи из файла ядра с помощью утилиты _jmap_.
- Использование инструмента _JConsole_. Операция `dumpHeap` предоставляется в _JConsole_ как MBean-компонент `HotSpotDiagnostic`. Эта операция запрашивает генерацию дампа в формате HPROF.

Метод на основе событий:

#### - Событие `OutOfMemoryError`: Если для исполняющегося приложения установлена опция командной строки `-XX:+HeapDumpOnOutOfMemoryError`, то при возникновении ошибки `OutOfMemoryError` генерируется дамп формата HPROF. Это идеальный метод для «production» систем, поскольку он практически обязателен для диагностирования проблем памяти и не сопровождается постоянными накладными расходами с точки зрения производительности. В старых выпусках сред исполнения Java на базе HotSpot для этого события не устанавливается предельное количество дампов кучи в пересчете на одну JVM; в более новых выпусках допускается не более одного дампа кучи для этого события на каждый запуск JVM.